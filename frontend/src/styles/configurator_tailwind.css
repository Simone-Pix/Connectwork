@layer components {
  /* BACKGROUND HERO */
  .hero {
    @apply flex items-center justify-center min-h-screen p-4;
  }

  /* --- CONTENITORE PRINCIPALE (MODALE) --- */
  .configurator {
    @apply relative rounded-xl shadow-2xl flex flex-col w-full bg-white overflow-hidden;
    max-width: 700px;
    height: 85vh;       /* Altezza relativa alla viewport */
    max-height: 650px;  /* Limite massimo altezza */
    min-height: 500px;  /* Limite minimo */
    box-shadow: 0 10px 40px rgba(0, 78, 152, 0.2);
    padding: 0; 
  }

  /* --- HEADER (Fisso in alto) --- */
  .step-header-container {
    @apply w-full px-6 py-4 flex items-center gap-4 bg-white z-10 border-b border-gray-100;
    flex-shrink: 0; /* Impedisce che si rimpicciolisca */
    min-height: 60px;
  }

  /* Progress Label & Bar Logic */
  .progress-label {
    @apply text-xs font-bold whitespace-nowrap;
    color: #004E98;
    min-width: 70px; /* Larghezza fissa per evitare salti */
  }

  .progress-bar-container {
    @apply h-1.5 rounded-full flex-1 bg-gray-200 overflow-hidden relative;
  }

  .progress-fill {
    @apply h-full rounded-full transition-all duration-500 ease-in-out bg-[#FF6700];
  }

  .step-title-wrapper {
    @apply w-full px-6 pt-4 pb-2 bg-white z-10 flex flex-col items-center justify-center;
    flex-shrink: 0; /* Impedisce che si schiacci */
    min-height: 80px; /* Altezza minima garantita per il titolo */
  }

  /* --- BODY (Scrollabile al centro) --- */
  .step-body-scroll {
    @apply flex-1 w-full overflow-y-auto px-6 py-2 flex flex-col;
    scrollbar-width: thin;
    scrollbar-color: #FF6700 #f1f1f1;
  }
  
  /* Titoli Sezioni */
  .section-title {
    @apply text-xl font-bold text-center mb-1 text-[#ff8a3d];
  }

  .section-subtitle {
    @apply text-xs text-center text-gray-400 mb-2;
  }

  /* --- FOOTER (Fisso in basso) --- */
  .button-group-footer {
    @apply w-full px-6 py-4 bg-white border-t border-gray-100 flex items-center justify-between z-10;
    flex-shrink: 0; /* Impedisce che si rimpicciolisca */
    min-height: 70px;
  }

  /* Bottoni */
  .back-btn {
    @apply px-4 py-2 rounded-full text-xs font-medium text-gray-600 hover:bg-gray-100 transition-colors border border-gray-200;
  }
  
  .next-btn {
    @apply px-6 py-2 rounded-full text-xs font-bold text-white shadow-md transition-transform hover:scale-105;
    background: linear-gradient(90deg, #ff7a18, #ff6126);
  }

  .next-btn:disabled {
    @apply opacity-50 cursor-not-allowed transform-none shadow-none grayscale;
  }

  /* --- INPUTS & FORMS --- */
  .input-group {
    @apply flex flex-col w-full mb-3;
  }

  .input-label {
    @apply block text-xs font-bold text-gray-700 mb-1 ml-1;
  }

  .input-standard {
    @apply w-full bg-transparent border border-gray-300 rounded-md px-3 py-2.5 text-sm text-black placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all;
  }
  
  /* Input Error State */
  .input-error {
    @apply border-red-500 bg-red-50 focus:ring-red-500;
  }

  .form-grid {
    @apply grid grid-cols-1 sm:grid-cols-2 gap-3 w-full;
  }

  /* --- CARDS (Step 1, 4, 5) --- */
  .card-container {
    @apply grid grid-cols-2 gap-3 w-full max-w-lg mx-auto;
  }

  .card {
    @apply w-full rounded-xl p-4 cursor-pointer flex flex-col items-center justify-center gap-2 border border-gray-100 transition-all bg-gray-50;
    min-height: 100px;
  }

  .card:hover {
    @apply bg-orange-50 border-orange-200;
  }

  .card.active {
    @apply ring-2 ring-[#004E98] bg-[#004E98] text-white shadow-lg transform -translate-y-1 border-transparent;
  }

  /* Override colori interni quando attivo */
  .card.active h4, 
  .card.active p, 
  .card.active .icon {
    color: white !important;
  }

  .card .icon { @apply text-2xl mb-1 text-gray-600; }
  .card h4 { @apply text-sm font-bold text-gray-800 text-center; }
  .card p { @apply text-xs text-gray-500 text-center; }

 /* --- MEDIA QUERY MOBILE --- */
  @media (max-width: 640px) {
    .configurator {
      height: 95vh; /* Pi√π spazio su mobile */
      border-radius: 12px;
    }
    .section-title { @apply text-lg; }
    .button-group-footer { @apply py-3; }
    
    /* Su mobile i campi input prendono tutta la larghezza */
    .form-grid { @apply grid-cols-1; }
    
    /* Le card rimangono a 2 colonne per risparmiare spazio verticale, 
       ma riduciamo il padding se necessario */
    .card { 
      @apply p-3;
      min-height: 90px; /* <--- CORRETTO: Uso CSS standard invece di @apply */
    }
  }
}